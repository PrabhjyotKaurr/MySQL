#GIVES TOTAL NUMBER OF ORDERS TILL DATE
DELIMITER $$
CREATE FUNCTION ORDERS_TILL_DATE(Time_stamp1 TIMESTAMP)
RETURNS INT
READS SQL DATA
DETERMINISTIC
BEGIN
RETURN (SELECT COUNT(Order_id) FROM Orders
WHERE Time_stamp <= Time_stamp1);
END $$
DELIMITER ;
SELECT ORDERS_TILL_DATE('2018-11-07 05:43:42');


#GIVES TOTAL NUMBER OF ORDERS DELIVERED BY STAFF
DELIMITER $$
CREATE FUNCTION ORDERS_BY(staff_id1 int)
RETURNS INT
READS SQL DATA
DETERMINISTIC
BEGIN
RETURN (SELECT Count(Staff_id) FROM orders
WHERE staff_id = staff_id1);
END $$
DELIMITER ;
SELECT ORDERS_BY(104);


#GIVES TOTAL REVENUE OVER MENU
DELIMITER $$
CREATE FUNCTION REVENUE_OVER_MENU(menu_name1 varchar(55))
RETURNS INT
READS SQL DATA
DETERMINISTIC
BEGIN
RETURN (SELECT SUM(Total_price) FROM Bill b
WHERE menu_name = menu_name1);
END $$
DELIMITER ;
SELECT REVENUE_OVER_MENU ('Biryani');


#GIVES TOTAL REVENUE TILL DATE
DELIMITER $$
CREATE FUNCTION REVENUE_TILL_DATE(Time_stamp1 TIMESTAMP)
RETURNS INT
READS SQL DATA
DETERMINISTIC
BEGIN
RETURN (SELECT SUM(Total_price) FROM Bill b
INNER JOIN Orders o ON o.order_id=b.order_id
WHERE Time_stamp<= Time_stamp1);
END $$
DELIMITER ;
SELECT REVENUE_TILL_DATE('2018-11-07 05:43:42');
